# Настройка голосовых чатов

## Требования для работы голосовых чатов

Для работы функции "Голосовой чат" необходимо установить дополнительные зависимости:

### 1. FFmpeg

FFmpeg требуется для обработки аудио и видео файлов.

**Ubuntu/Debian:**
```bash
sudo apt-get update
sudo apt-get install ffmpeg
```

**macOS:**
```bash
brew install ffmpeg
```

### 2. PyTgCalls

Библиотека для работы с голосовыми чатами Telegram.

```bash
pip install pytgcalls
```

**Важно:** Если возникают ошибки при установке, попробуйте установить версию 2.x:
```bash
pip install pytgcalls==2.1.0
```

### 3. Дополнительные зависимости (Linux)

На Linux может потребоваться установка дополнительных пакетов:

```bash
sudo apt-get install python3-dev libasound2-dev
```

## Проверка установки

После установки запустите бота и попробуйте запустить голосовой чат. Если возникают ошибки:

1. Проверьте версию pytgcalls:
```bash
python3 -c "import pytgcalls; print(pytgcalls.__version__)"
```

2. Проверьте наличие ffmpeg:
```bash
ffmpeg -version
```

3. Проверьте логи бота на наличие ошибок импорта.

## Использование

1. Поместите аудиофайлы в папку `audio/`
2. Для видео - поместите файлы в папку `video/`
3. В боте выберите "Запустить действие" → "Голосовой чат"
4. Следуйте инструкциям бота

## Поддерживаемые форматы

**Аудио:** MP3, WAV, OGG, M4A, FLAC
**Видео:** MP4, AVI, MKV, MOV, WebM

## Устранение неполадок

### Ошибка "cannot import name 'GroupCallFactory'"

Это означает, что установлена несовместимая версия pytgcalls. Попробуйте:

```bash
pip uninstall pytgcalls -y
pip install pytgcalls==2.1.0
```

### Ошибка "Библиотека pytgcalls недоступна"

Убедитесь, что pytgcalls установлен в том же виртуальном окружении, что и бот:

```bash
# Активируйте виртуальное окружение
source venv/bin/activate  # Linux/macOS
# или
venv\Scripts\activate  # Windows

# Установите pytgcalls
pip install pytgcalls
```

### Ошибка при воспроизведении

1. Убедитесь, что файлы существуют и доступны для чтения
2. Проверьте формат файлов (должны быть поддерживаемые форматы)
3. Убедитесь, что ffmpeg установлен и доступен в PATH
4. Проверьте права доступа к папкам audio/ и video/

## Примечание

Функция голосового чата работает только на Linux серверах. На macOS и Windows могут возникать проблемы совместимости с pytgcalls.
